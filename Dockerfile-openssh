FROM alpine

RUN set -e;                                             \
    /usr/bin/ssh-keygen -A;                             \
    passwd -l root;                                     \
    apk add --no-cache openssh nano curl sudo ;         \
    sed -i                                              \
      's/#\(PasswordAuthentication\) yes/\1 no/'        \
      /etc/ssh/sshd_config; \
    && rm -rf /var/cache/apk/*
    
EXPOSE 22

CMD ["/usr/sbin/sshd", "-D", "-e", "-f", "/etc/ssh/sshd_config"]
